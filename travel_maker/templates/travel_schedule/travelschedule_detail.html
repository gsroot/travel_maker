{% extends "base.html" %}

{% load static i18n scheduletags %}

{% block css %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'vendor/fullcalendar/dist/fullcalendar.css' %}">
    <link rel="stylesheet" href="{% static 'css/travelschedule_detail.css' %}">
{% endblock %}

{% block header %}
    <header>
        <div class="spacer-xl"></div>
        <div class="spacer-md"></div>
        <div class="header-title">
            {{ travelschedule.title }}
        </div>
    </header>
{% endblock %}

{% block content %}
    {% get_or_create_calendar travelschedule as calendar %}
    <div class="spacer-md"></div>
    <div class="container">
        <div class="row">
            <div class="col-md-3">
                {% include 'travel_schedule/snippets/schedule_item_panel.html' %}
            </div>
            <div class="col-md-9">
                {% include 'travel_schedule/snippets/schedule_item_overview.html' %}
                <div class="spacer-xs"></div>
                <div id="calendar" class="box"></div>
            </div>
        </div>
    </div>

{% endblock %}

{% block javascript %}
    {% get_or_create_calendar travelschedule as calendar %}
    {{ block.super }}
    <script type='text/javascript' src="{% static 'vendor/moment/moment.js' %}"></script>
    <script type='text/javascript' src="{% static 'vendor/fullcalendar/dist/fullcalendar.js' %}"></script>
    <script type="text/javascript" src="{% static 'vendor/fullcalendar/dist/locale/ko.js' %}"></script>
    <script type='text/javascript'>
        $(document).ready(function () {
            /* initialize the calendar
             -----------------------------------------------------------------*/
            $('#calendar').fullCalendar({
                header: {
                    left: '',
                    center: '',
                    right: ''
                },
                views: {
                    agendaDuration: {
                        type: 'agenda',
                        duration: {days: {{ travelschedule.duration_days }}},
                    }
                },
                defaultDate: moment('{{ travelschedule.start|date:"c" }}'),
                defaultView: 'agendaDuration',
                contentHeight: 'auto',
                lang: 'ko',
                editable: false,
                droppable: false,
                allDaySlot: false,
                events: [
                    {% for event in travelschedule.events %}
                        {
                            title: '{{ event.event.title }}',
                            start: '{{ event.event.start|date:"c" }}',
                            end: '{{ event.event.end|date:"c" }}',
                            allDay: false
                        },
                    {% endfor %}
                ]
            });
        });
    </script>
{% endblock %}